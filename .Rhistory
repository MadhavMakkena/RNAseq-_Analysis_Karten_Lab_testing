title="sym_result_exp100",
norm="WT",
eb="se",
col=c("blue","yellow"),
ord=NULL)
view(cond)
view(cond)
cond
barGene(genes=Gene_set_chol_biosyn,
counts=log10(1+sym_counts_100),
conditions=cond,
title="sym_result_exp100",
norm="Fibroblast",
eb="se",
col=c("blue","yellow"),
ord=NULL)
barGene(genes=Gene_set_chol_biosyn,
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
barGene(genes=Gene_set_chol_biosyn,
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
barGene(genes=Gene_set_chol_biosyn,
aes(x=x, y=y, width=.5)
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
barGene(genes=Gene_set_chol_biosyn,
aes(x=x, y=y, width=.5),
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
barGene(genes=Gene_set_chol_biosyn,
width=.5,
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
barGene(genes=Gene_set_chol_biosyn,
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
barGene(genes=Gene_set_chol_homeo,
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Homeostasis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col=c("blue","yellow"))
ggplot(sym_counts_100, aes(x=dose, y=len)) +
geom_violin(trim=FALSE)
library(ggplot2)
ggplot(sym_counts_100, aes(x=dose, y=len)) +
geom_violin(trim=FALSE)
ggplot(sym_counts_100, aes(x=len, y=len)) +
geom_violin(trim=FALSE)
barGene(genes=Gene_set_chol_biosyn,
counts=log10(1+sym_counts_100),
conditions=cond,
title="Cholesterol Biosynthesis",
norm="Fibroblast",
eb="se",
returnDat=T,
ord=c("Fibroblast","SH-SY5Y"),
col="Dark2")
geom_violin(trim=FALSE)
ggplot(sym_counts_100, geom_violin(trim=FALSE)
library(ggplot2)
ggplot(sym_counts_100)
DEG<-volcanoPlot(res=sym_result_100, #Results object
title="Fibroblast vs SH-SY5",
p=0.05, #adjusted p-value threshold for DEGs
pval=NULL, #unadjusted p-value threshold for DEGs (in case you don't want to use adjusted)
FC=log2(1.5), #log2FoldChange threshold for DEGs (can be 0)
lab=Gene_set_chol_biosyn, #list of genes to label (NULL to not label any)
col=Gene_set_chol_biosyn, #list of genes to colour (NULL to not colour any)
fclim=NULL, #x-axis (log2FoldChange) limits, genes passing this limit will be represented as triangles on the edge of the plot - good if you have some extreme outliers
showNum=T, #Show the numbers of genes on the plot?
returnDEG=T, #Return list of DEGs (Down, Up) - this is good for running GO later on
expScale=F, #Scale point size to mean expression?
upcol=NULL, #Colour value for upregulated genes, NULL will be red
dncol=NULL) #Colour value for downregulated genes, NULL will be blue)
DEG<-volcanoPlot(res=sym_result_100, #Results object
title="Fibroblast vs SH-SY5",
p=0.05, #adjusted p-value threshold for DEGs
pval=NULL, #unadjusted p-value threshold for DEGs (in case you don't want to use adjusted)
FC=log2(1.5), #log2FoldChange threshold for DEGs (can be 0)
lab=Gene_set_chol_biosyn, #list of genes to label (NULL to not label any)
col=NULL, #list of genes to colour (NULL to not colour any)
fclim=NULL, #x-axis (log2FoldChange) limits, genes passing this limit will be represented as triangles on the edge of the plot - good if you have some extreme outliers
showNum=T, #Show the numbers of genes on the plot?
returnDEG=T, #Return list of DEGs (Down, Up) - this is good for running GO later on
expScale=F, #Scale point size to mean expression?
upcol=NULL, #Colour value for upregulated genes, NULL will be red
dncol=NULL) #Colour value for downregulated genes, NULL will be blue)
DEG<-volcanoPlot(res=sym_result_100, #Results object
title="Fibroblast vs SH-SY5",
p=0.05, #adjusted p-value threshold for DEGs
pval=NULL, #unadjusted p-value threshold for DEGs (in case you don't want to use adjusted)
FC=log2(1.5), #log2FoldChange threshold for DEGs (can be 0)
lab=NULL, #list of genes to label (NULL to not label any)
col=Gene_set_chol_biosyn, #list of genes to colour (NULL to not colour any)
fclim=NULL, #x-axis (log2FoldChange) limits, genes passing this limit will be represented as triangles on the edge of the plot - good if you have some extreme outliers
showNum=T, #Show the numbers of genes on the plot?
returnDEG=T, #Return list of DEGs (Down, Up) - this is good for running GO later on
expScale=F, #Scale point size to mean expression?
upcol=NULL, #Colour value for upregulated genes, NULL will be red
dncol=NULL) #Colour value for downregulated genes, NULL will be blue)
MA_Plot(res=sym_result_100,
title="Fibroblast vs SH-SY5",
p=0.05,
pval=NULL,
FC=log2(1.5),
lab=Gene_set_chol_biosyn,
col=Gene_set_chol_biosyn,
fclim=NULL, #Same as volcano plot, but will act on y-axis, not x
showNum=T,
returnDEG=F,
sigScale=F, #Scale point size to significance?
upcol=NULL,
dncol=NULL)
dir.create("GO")
GO_res<-GO_GEM(geneList=DEG,
species="hsapiens",
bg=rownames(sym_result_100), #A character vector of genes indicating the background for the GO analysis. Leave NULL to use all genes (if you don't have one)
source="GO:BP", #A character indicating the source - see documentation for all of them
corr="fdr", #How to correct the p-values
iea=F, #Remove genes in terms 'inferred by electronic analysis' ?
prefix="GO/", #Character for output prefix. If named list is provided as geneList, names of the list will be added to the prefix
ts=c(10,500), #numeric of length 2 indicating minimum/maximum term size for results plots
pdf=F, #print figures to pdf?
fig=T, #Show figures in plots in RStudio?
figCols=c("blue","orange"), #colours for enrichment/significance in plots
returnGost=F, #Return gprofiler2 gost object
writeRes=F, #Write results to ".GO.txt" file
writeGem=F, #Write gem file?
writeGene=F, #Write genes in query to file?
returnRes=T) #Return the results table (only one of returnRes or returnGost can be T, not both)
GO_res<-GO_GEM(geneList=DEG,
species="hsapiens",
bg=rownames(sym_result_100), #A character vector of genes indicating the background for the GO analysis. Leave NULL to use all genes (if you don't have one)
source="GO:BP", #A character indicating the source - see documentation for all of them
corr="fdr", #How to correct the p-values
iea=F, #Remove genes in terms 'inferred by electronic analysis' ?
prefix="GO/", #Character for output prefix. If named list is provided as geneList, names of the list will be added to the prefix
ts=c(10,500), #numeric of length 2 indicating minimum/maximum term size for results plots
pdf=T, #print figures to pdf?
fig=T, #Show figures in plots in RStudio?
figCols=c("blue","orange"), #colours for enrichment/significance in plots
returnGost=T, #Return gprofiler2 gost object
writeRes=T, #Write results to ".GO.txt" file
writeGem=T, #Write gem file?
writeGene=F, #Write genes in query to file?
returnRes=T) #Return the results table (only one of returnRes or returnGost can be T, not both)
GO_gost<-GO_GEM(geneList=DEG,
species="hsapiens",
bg=rownames(sym_result_100),
source="GO:BP",
prefix="GO/",
pdf=F,
fig=F,
returnGost=T,
writeRes=F)
BinfTools:::combGO_plot(GOresList=GO_res,
title="Biological process - significant",
ts=c(10,500),
sig=T,
numTerm=10,
upcols=c("lightpink","red"),
downcols=c("lightblue","blue"))
BinfTools:::combGO_plot(GOresList=GO_res,
title="Biological process - enriched",
ts=c(10,500),
sig=F,
numTerm=10,
upcols=c("lightpink","red"),
downcols=c("lightblue","blue"))
rnk<-GenerateGSEA(res=symRes, #Results object
filename="GSEA.rnk", #Output rnk file name for GSEA preranked outside of R
bystat=T, #Rank genes by stats? will use Wald statistic or if not nere, -log10(p-value) with the direction from the log2FoldChange
byFC=F, #Rank genes by log2FoldChange? I like to use this with the shrunken log fold change from DESEq2
retRNK=T) #Return the RNK object? yes, to run GSEA in R
rnk<-GenerateGSEA(res=sym_result_100, #Results object
filename="GSEA.rnk", #Output rnk file name for GSEA preranked outside of R
bystat=T, #Rank genes by stats? will use Wald statistic or if not nere, -log10(p-value) with the direction from the log2FoldChange
byFC=F, #Rank genes by log2FoldChange? I like to use this with the shrunken log fold change from DESEq2
retRNK=T) #Return the RNK object? yes, to run GSEA in R
library(gpGeneSets)
gsea_res<-GSEA(rnk=rnk, #Rnk object
gmt=gp_dm, #either .gmt filename or a loaded gene set
pval=1, #adjusted p-value threshold for terms to return, set to 1 to return all terms and filter later
ts=c(10,600), #min/max term sizes to filter terms BEFORE analysis
nperm=10000, #number of permuations for p-value generation
parseBader=F) #Set to TRUE if using Gary's genesets - it will parse the term names so it looks neater. I'm not using gary's genesets here, so we will set to FALSE
rows<-c(1, nrow(gsea_res))
enPlot(gseaRes=gsea_res[rows,], #GSEA results table subset into the rows of interest to make a plot
rnk=rnk, #Original rnk object used to make gsea_res
gmt=gp_dm, #Original gmt object/filename used to make gsea_res
title=NULL) #character vector of length (nrow(gseaRes)) for custom titles, or leave NULL for automatic titles - works better for Gary's genesets
cholesterol<-c(customGMT(gost=GO_gost$Down, #gost object from GO_GEM and returnGost=T
key="cholesterol", #keyword to pull gene sets - this is a grep, so anything with this key will be pulled - the resulting geneset may require some manual curation so check the names
gmt=gp_dm), #The gpGeneSets object containing the complete gene sets 'gp_hs' for human, 'gp_mm' for mouse and 'gp_dm' for drosophila
customGMT(gost=GO_gost$Up,
key="cholesterol",
gmt=gp_dm))
View(cholesterol)
write.gmt(geneSet=cholesterol,
filename="cholesterol.gmt")
write.txt(geneSet=cholesterol,
filename="cholesterol.txt")
write.csv(geneSet=cholesterol,
filename="cholesterol.csv")
forVenn<-list(DE_Up=DEG$Up,
DE_Down=DEG$Down,
Rhodopsin=unique(unlist(cholesterol)))
plotVenn(x=forVenn, #name list for plotting Venn diagram
title="cholesterol related genes",
cols="Dark2", #Colour scheme for plot
lty="blank", #outlines for circles
scale=F, #Scale to list sizes?
retVals=F) #Return list of values in overlaps?
forVenn<-list(DE_Up=DEG$Up,
DE_Down=DEG$Down,
cholesterol=unique(unlist(cholesterol)))
plotVenn(x=forVenn, #name list for plotting Venn diagram
title="cholesterol related genes",
cols="Dark2", #Colour scheme for plot
lty="blank", #outlines for circles
scale=F, #Scale to list sizes?
retVals=F) #Return list of values in overlaps?
gsva_plot(counts=as.matrix(symCounts), #counts object (as matrix), make sure rownames are the same nomenclature as the gene symbols in geneset
geneset=cholesterol,
method="gsva", #Method for gsva plot - see documentation for options
condition=cond,
con="WT", #Indicate the control condition
title="cholesterol ssGSEA",
compare=NULL, #for pairwise t-tests, leave NULL to do all possible comparisons, or provide a list of vectors, length 2 indicating the conditions to compare
col="Dark2", #Colour scheme, can be RColourBrewer palette name, or vector of rgb(), hexadecimal, or colour names
style="violin")
gsva_plot(counts=as.matrix(sym_counts_100), #counts object (as matrix), make sure rownames are the same nomenclature as the gene symbols in geneset
geneset=cholesterol,
method="gsva", #Method for gsva plot - see documentation for options
condition=cond,
con="WT", #Indicate the control condition
title="cholesterol ssGSEA",
compare=NULL, #for pairwise t-tests, leave NULL to do all possible comparisons, or provide a list of vectors, length 2 indicating the conditions to compare
col="Dark2", #Colour scheme, can be RColourBrewer palette name, or vector of rgb(), hexadecimal, or colour names
style="violin")
View(sym_counts_100)
sym_counts_100_1 <- counts_100
sym_counts_100_1 <- getSym(object=sym_counts_100_1,
obType="counts",
species="hsapiens",
target="ESNG",
addCol=F)
head(sym_counts_100_1)
#
# getting HGNC Names from ENSG names for counts_100
sym_counts_100 <- counts_100
gsva_plot(counts=as.matrix(counts_100), #counts object (as matrix), make sure rownames are the same nomenclature as the gene symbols in geneset
geneset=cholesterol,
method="gsva", #Method for gsva plot - see documentation for options
condition=cond,
con="WT", #Indicate the control condition
title="cholesterol ssGSEA",
compare=NULL, #for pairwise t-tests, leave NULL to do all possible comparisons, or provide a list of vectors, length 2 indicating the conditions to compare
col="Dark2", #Colour scheme, can be RColourBrewer palette name, or vector of rgb(), hexadecimal, or colour names
style="violin")
count_plot(counts=symCounts,
scaling="none", #Can be "zscore" to emphasize differences, or 'log10', or "none"
genes=unique(unlist(rhodopsin)), #Character vector of gene names - need to unlist the geneset for this
condition=cond,
con="WT",
title="Rhodopsin Genes Expression",
compare=NULL,
col="Dark2",
method="perMean", #What method to plot? "mean", "median", "perMean", "ind", "geoMean"
pair=F, #Paired t-tests?
pc=1, #pseudocount if scaling="log10"
yax="Percent Mean Expression", #y-axis label if default isn't descriptive enough
showStat=T, #Show statistics on plot?
style="box") #Default is violin
#Bioconductor packages don't install automatically on BinfTools install
BiocManager::install("SAGx")
devtools::update_packages("BinfTools")
#setting the directory
setwd("/Users/madhavmakkena/Downloads/RNAseq")
#loading the count data (only when its already in a single file)
count_data <- read.csv("combined_single.csv", header = TRUE, sep = ",", row.names = "ENSGene")
#loading the sample information
sample_data <- read.csv('sample_conditions.csv', header = TRUE, row.names = "sample")
#checking if the sample names in sample data match the count data
all (rownames(sample_data) %in% colnames(count_data))
all (rownames(sample_data) == colnames(count_data))
#cleaning up count_data to remove genes with 0 counts in all samples
count_data<- count_data[rowSums(count_data) != 0, ]
#DESeq analysis
#storing the input values from count_data_clean
library(DESeq2)
DESeq <- DESeqDataSetFromMatrix(countData = count_data, colData = sample_data, design = ~ condition)
#Excluding rows with less than 20 combined total reads or 10 mean total reads
keep <- rowSums(counts(DESeq)) >= 20
DESeq <- DESeq[keep,]
rm(keep)
keep <- rowMeans(counts(DESeq)) >= 10
DESeq <- DESeq[keep,]
rm(keep)
DESeq_hist <- sort(rowMeans(counts(estimateSizeFactors(DESeq), normalized = T)), decreasing = T)
summary(DESeq)
summary(DESeq_hist)
#plotting expression count histograms
hist(DESeq_hist, breaks = 1000000, col = "grey", xlim=c(0,100), ylim=c(0,100))
#performing DESeq2 on exp_100_sort
DESeq <-DESeq(DESeq)
plotDispEsts(DESeq)
#normalising the counts exp
count <- as.data.frame(counts(DESeq, normalized=TRUE))
head(count,10)
#extracting the results from DESeq
result <- as.data.frame(results(DESeq, contrast=c("condition", "Fibroblast", "SH-SY5Y")))
head(result,10)
#extracting the conditions from DESeq
cond<-as.character(DESeq$condition)
lapply(c("SAGx", "GSVA", "fgsea", "gage", "qusage", "gpGeneSets", "BinfTools"), require, character.only = TRUE)
# getting HGNC Names from ENSG names for result_exp100
result_HGCN <- result
result_HGCN <- getSym(object=result_HGCN,
obType="res",
species="hsapiens",
target="HGNC",
addCol=F)
#installing packages for BinfTools
# BiocManager::install("SAGx")
# BiocManager::install("GSVA")
# BiocManager::install("fgsea")
# BiocManager::install("gage")
# BiocManager::install("qusage")
# devtools::install_github("kevincjnixon/gpGeneSets")
devtools::install_github("kevincjnixon/BinfTools", force = TRUE)
lapply(c("SAGx", "GSVA", "fgsea", "gage", "qusage", "gpGeneSets", "BinfTools"), require, character.only = TRUE)
# getting HGNC Names from ENSG names for result_exp100
result_HGCN <- result
result_HGCN <- getSym(object=result_HGCN,
obType="res",
species="hsapiens",
target="HGNC",
addCol=F)
remove.packages("BinfTools")
library("BinfTools")
#installing packages for BinfTools
# BiocManager::install("SAGx")
# BiocManager::install("GSVA")
# BiocManager::install("fgsea")
# BiocManager::install("gage")
# BiocManager::install("qusage")
# devtools::install_github("kevincjnixon/gpGeneSets")
devtools::install_github("kevincjnixon/BinfTools", force = TRUE)
#setting the directory
setwd("/Users/madhavmakkena/Downloads/RNAseq")
#loading the count data (only when its already in a single file)
count_data <- read.csv("combined_single.csv", header = TRUE, sep = ",", row.names = "ENSGene")
#loading the sample information
sample_data <- read.csv('sample_conditions.csv', header = TRUE, row.names = "sample")
#checking if the sample names in sample data match the count data
all (rownames(sample_data) %in% colnames(count_data))
all (rownames(sample_data) == colnames(count_data))
#cleaning up count_data to remove genes with 0 counts in all samples
count_data<- count_data[rowSums(count_data) != 0, ]
#DESeq analysis
#storing the input values from count_data_clean
library(DESeq2)
DESeq <- DESeqDataSetFromMatrix(countData = count_data, colData = sample_data, design = ~ condition)
#Excluding rows with less than 20 combined total reads or 10 mean total reads
keep <- rowSums(counts(DESeq)) >= 20
DESeq <- DESeq[keep,]
rm(keep)
keep <- rowMeans(counts(DESeq)) >= 10
DESeq <- DESeq[keep,]
rm(keep)
DESeq_hist <- sort(rowMeans(counts(estimateSizeFactors(DESeq), normalized = T)), decreasing = T)
summary(DESeq)
summary(DESeq_hist)
#plotting expression count histograms
hist(DESeq_hist, breaks = 1000000, col = "grey", xlim=c(0,100), ylim=c(0,100))
#performing DESeq2 on exp_100_sort
DESeq <-DESeq(DESeq)
plotDispEsts(DESeq)
#normalising the counts exp
count <- as.data.frame(counts(DESeq, normalized=TRUE))
head(count,10)
#extracting the results from DESeq
result <- as.data.frame(results(DESeq, contrast=c("condition", "Fibroblast", "SH-SY5Y")))
head(result,10)
#extracting the conditions from DESeq
cond<-as.character(DESeq$condition)
#installing packages for BinfTools
# BiocManager::install("SAGx")
# BiocManager::install("GSVA")
# BiocManager::install("fgsea")
# BiocManager::install("gage")
# BiocManager::install("qusage")
# devtools::install_github("kevincjnixon/gpGeneSets")
devtools::install_github("kevincjnixon/BinfTools", force = TRUE)
devtools::update_packages("BinfTools")
library("BinfTools")
lapply(c("SAGx", "GSVA", "fgsea", "gage", "qusage", "gpGeneSets", "BinfTools"), require, character.only = TRUE)
# getting HGNC Names from ENSG names for result_exp100
result_HGCN <- result
result_HGCN <- getSym(object=result_HGCN,
obType="res",
species="hsapiens",
target="HGNC",
addCol=F)
remove.packages("BinfTools")
#installing packages for BinfTools
# BiocManager::install("SAGx")
# BiocManager::install("GSVA")
# BiocManager::install("fgsea")
# BiocManager::install("gage")
# BiocManager::install("qusage")
# devtools::install_github("kevincjnixon/gpGeneSets")
devtools::install_github("kevincjnixon/BinfTools", force = TRUE)
devtools::update_packages("BinfTools")
library("BinfTools")
#setting the directory
setwd("/Users/madhavmakkena/Downloads/RNAseq")
#loading the count data (only when its already in a single file)
count_data <- read.csv("combined_single.csv", header = TRUE, sep = ",", row.names = "ENSGene")
#loading the sample information
sample_data <- read.csv('sample_conditions.csv', header = TRUE, row.names = "sample")
#checking if the sample names in sample data match the count data
all (rownames(sample_data) %in% colnames(count_data))
all (rownames(sample_data) == colnames(count_data))
#cleaning up count_data to remove genes with 0 counts in all samples
count_data<- count_data[rowSums(count_data) != 0, ]
#DESeq analysis
#storing the input values from count_data_clean
library(DESeq2)
DESeq <- DESeqDataSetFromMatrix(countData = count_data, colData = sample_data, design = ~ condition)
#Excluding rows with less than 20 combined total reads or 10 mean total reads
keep <- rowSums(counts(DESeq)) >= 20
DESeq <- DESeq[keep,]
rm(keep)
keep <- rowMeans(counts(DESeq)) >= 10
DESeq <- DESeq[keep,]
rm(keep)
DESeq_hist <- sort(rowMeans(counts(estimateSizeFactors(DESeq), normalized = T)), decreasing = T)
summary(DESeq)
summary(DESeq_hist)
#plotting expression count histograms
hist(DESeq_hist, breaks = 1000000, col = "grey", xlim=c(0,100), ylim=c(0,100))
#performing DESeq2 on exp_100_sort
DESeq <-DESeq(DESeq)
plotDispEsts(DESeq)
#normalising the counts exp
count <- as.data.frame(counts(DESeq, normalized=TRUE))
head(count,10)
#extracting the results from DESeq
result <- as.data.frame(results(DESeq, contrast=c("condition", "Fibroblast", "SH-SY5Y")))
head(result,10)
#extracting the conditions from DESeq
cond<-as.character(DESeq$condition)
#installing packages for BinfTools
# BiocManager::install("SAGx")
# BiocManager::install("GSVA")
# BiocManager::install("fgsea")
# BiocManager::install("gage")
# BiocManager::install("qusage")
# devtools::install_github("kevincjnixon/gpGeneSets")
devtools::install_github("kevincjnixon/BinfTools", force = TRUE)
devtools::update_packages("BinfTools")
library("BinfTools")
lapply(c("SAGx", "GSVA", "fgsea", "gage", "qusage", "gpGeneSets", "BinfTools"), require, character.only = TRUE)
# getting HGNC Names from ENSG names for result_exp100
result_HGCN <- result
result_HGCN <- getSym(object=result_HGCN,
obType="res",
species="hsapiens",
target="HGNC",
addCol=F)
